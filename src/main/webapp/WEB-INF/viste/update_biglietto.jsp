<%@include file="header.jsp"%>

<div class="container">

	<div class="row mt-3">
		<div id="films" class="col-12 col-sm-6 col-md-6 bg-light"></div>

		<div class="col-12 col-sm-6 col-md-6 bg-light">
        <div class="row">

        <div class="col-6 col-sm-5 col-md-6 bg-light">
			<div class="row row-cols-1 mt-2">

				<div class="col ">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="A1" title="A1"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="A2" title="A2"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="A3" title="A3"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="A4" title="A4"
						type="submit">&#10148;</button>


				</div>
				<div class="col">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="B1" title="B1"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="B2" title="B2"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="B3" title="B3"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="B4" title="B4"
						type="submit">&#10148;</button>


				</div>
				<div class="col">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="C1" title="C1"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="C2" title="C2"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="C3" title="C3"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="C4" title="C4"
						type="submit">&#10148;</button>


				</div>
				<div class="col">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="D1" title="D1"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="D2" title="D2"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="D3" title="D3"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="D4" title="D4"
						type="submit">&#10148;</button>


				</div>
				<div class="col">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="E1" title="E1"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="E2" title="E2"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="E3" title="E3"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="E4" title="E4"
						type="submit">&#10148;</button>


				</div>
			</div>

        </div>
        
		<div class="col-6 col-sm-5 col-md-6 bg-light">
		    <div class="row row-cols-1 mt-2">

			    <div class="col">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="A5" title="A5"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="A6" title="A6"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="A7" title="A7"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="A8" title="A8"
						type="submit">&#10148;</button>


				</div>
				<div class="col">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="B5" title="B5"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="B6" title="B6"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="B7" title="B7"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="B8" title="B8"
						type="submit">&#10148;</button>


				</div>
				<div class="col">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="C5" title="C5"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="C6" title="C6"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="C7" title="C7"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="C8" title="C8"
						type="submit">&#10148;</button>


				</div>
				<div class="col">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="D5" title="D5"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="D6" title="D6"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="D7" title="D7"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="D8" title="D8"
						type="submit">&#10148;</button>


				</div>
				<div class="col">
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="E5" title="E5"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="E6" title="E6"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="E7" title="E7"
						type="submit">&#10148;</button>
					<button class="btn btn-outline-primary text-center"
						style="width: 2rem text-center" value="E8" title="E8"
						type="submit">&#10148;</button>


				</div>
			
		    </div>
	    </div>
		           
        <div class="col-6 col sm-5 col-md-12 my-5">

                <form action="/biglietto/updateBiglietto/${biglietto.getId()}"
                    method="post">
    
                    <label for="film_id" class="form-label">Inserire il numero del
                        film che si vuole selezionare</label> <input style="width:4rem" type="text" name="film_id"
                        class="form-control" id="film_id" aria-describedby="film_id"
                        value="${biglietto.film_id}"> <label for="quantita"
                        class="form-label">Quantit&aacute;</label>
                        <select style="width:4rem; margin-bottom:0.5rem" class="form-select"
                        name="quantita" aria-label="Default select example">
                        <option selected>${biglietto.quantita}</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        </select>
						<label for="posto">Seleziona il posto</label><br>
						 <input type="text" style="margin-right:2rem" id="posto" name="posto" placeholder="posto">
    
                        <input type="hidden" name="utente_username" class="form-control"
                        id="utente_username" aria-describedby="utente_username"
                        value="${biglietto.utente_username}">
    
                    <button type="submit" class="btn btn-primary" value="update biglietto">salva</button>
    
                </form>
        
        </div>
        </div>
        </div> 
		
	</div>



	
</div>

<script type="text/javascript">
	var http = new XMLHttpRequest();
	const url = "http://localhost:9011/api/films";
	http.open("GET", url, true);
	http.send();
	http.onreadystatechange = function() {

		if (this.readyState == 4 && this.status == 200) {
			console.log(this.readyState);
			console.log(this.status);

			var myObj = JSON.parse(this.responseText);

			var films = document.getElementById("films");

			for (var i = 0; i < myObj.length; i++) {
				films.innerHTML += myObj[i].id + ') ' + myObj[i].titolo + ' - '
						+ myObj[i].giorno + '<br>';
			}
		}
	}

	var pulsanti = document.getElementsByClassName('btn btn-outline-primary');
	var posto = document.getElementById("posto");
	
	var h = new XMLHttpRequest();

	const urlBigl = "http://localhost:9011/api/biglietti";
	h.open("GET", urlBigl, true);
	h.send();

	h.onreadystatechange = function() {

		if (this.readyState == 4 && this.status == 200) {
			console.log(this.readyState);
			console.log(this.status);

			var myObj = JSON.parse(this.responseText);

			console.log(myObj)
			for (var i = 0; i < myObj.length; i++) {
				var seat = myObj[i].posto;
				console.log(seat);
				// var seat = myObj[i].posto;
				for (var j = 0; j < pulsanti.length; j++) {

					if (seat.includes(pulsanti[j].value)) {
						console.log(pulsanti[j].value);
						posto.value += ' ' + pulsanti[j].value + ' ';
						pulsanti[j].setAttribute("class",
								"btn btn-danger disabled");

					}

				}

			}
		}

	}

	var p = [ ' A1 ', ' A2 ', ' A3 ', ' A4 ', ' B1 ', ' B2 ', ' B3 ', ' B4 ', ' C1 ',
			' C2 ', ' C3 ', ' C4 ', ' D1 ', ' D2 ', ' D3 ', ' D4 ', ' E1 ', ' E2 ',
			' E3 ', ' E4 ', ' A5 ', ' A6 ', ' A7 ', ' A8 ', ' B5 ', ' B6 ', ' B7 ',
			' B8 ', ' C5 ', ' C6 ', ' C7 ', ' C8 ', ' D5 ', ' D6 ', ' D7 ', ' D8 ',
			' E5 ', ' E6 ', ' E7 ', ' E8 ' ];

	for (var i = 0; i < p.length; i++) {
		//posto.value = p[i];
		(function(index) {
			pulsanti[index].onclick = function() {
				posto.value += p[index]
			};
		})(i)
	}
</script>

<%@include file="footer.jsp"%>